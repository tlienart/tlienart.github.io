<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
		 <!-- Un-minified script so that can play a bit -->
<link rel="stylesheet" href="/libs/katex/katex.min.css"></link>
 		
        
		
			<link rel="stylesheet" href="/css/main.css">
	        <link rel="icon" href="/assets/infra/favicon.png">
		
		 <title>Convex analysis II</title>	
	</head>
    <body>
		
        <header>
            <div class="blog-name"><a href="/">Thibaut Lienart</a></div>
            <nav>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/pub/csml.html">CS/ML notes</a></li>
                    <li><a href="/pub/julia.html">Julia notes</a></li>
                    <!-- <li><a href="/pub/misc.html">Misc.</a></li> -->
                </ul>
                <img src="/assets/infra/hamburger.svg" id="menu-icon">
            </nav>
        </header>
		

<!-- Content appended here -->

<div class="jd-content">
<h1><a id="convex-analysis-part-2" href="#convex-analysis-part-2">Convex analysis &#40;part 2&#41;</a></h1>
<h2><a id="the-convex-conjugate" href="#the-convex-conjugate">The convex conjugate</a></h2>
<p>Let us start with the definition of the subdifferential of a convex function \(f\) at a point \(x\in C\):</p>
\[\begin{array}{c} 
    \partial f(x) &=& \{y\in \mathbb R^n\,|\, f(z)\,\ge\, f(x)+\langle z-x,y\rangle, \,\forall z\in C\},
\end{array}\] We can rearrange terms in the condition as follows: \[\begin{array}{c} 
    \partial f(x) &=& \{y\in\mathbb R^n\,|\, \langle z,y\rangle - f(z)\,\le\, \langle x,y\rangle - f(x), \,\forall z\in C\}.
\end{array}\] However, since the condition must hold for all \(z\), it must equivalently hold for any \(z\) that maximises the lower bound. Note that the maximum of that lower bound tightens the inequality exactly &#40;take \(z=x\)&#41;. We can thus write the subdifferential as</p>
<a id="def-subdiff-1"></a>\[
    \partial f(x) \quad\!\! =\quad\!\! \{y\in \mathbb R^n \,|\, \max_{z\in C} \,\, [\langle z,y\rangle -f(z)] \,=\, \langle x,y\rangle -f(x)\}.
\]
<p>We can now introduce the <em>convex conjugate</em> of a function &#40;also sometimes known as the <em>Fenchel-Legendre convex conjugate</em> or a combination of those words&#41;. We write \(\overline{\mathbb R}\) the extended real line: \(\overline{\mathbb R} = \mathbb R \cup \{\pm\infty\}\).</p>
<div class="colbox-blue">Let \(f: C\to \overline{\mathbb R}\) denote any function. The <em>convex conjugate</em> of \(f\) is the function \(f^\star(y):\mathbb R^n\to \overline{\mathbb R}\) defined as follows:</p>
\[
    f^\star(y) \quad\!\! :=\quad\!\! \sup_{z\in C} \,\,[\langle z,y \rangle - f(z)].
\]</div>

<p><strong>Note</strong>: it&#39;s easy to show that the convex conjugate of a function \(f\) is convex even if the function \(f\) is not convex.</p>
<p>We can now use the convex conjugate in <span class="eqref">(<a href="#def-subdiff-1">3</a>)</span>: <a id="def-subdiff-2"></a>\[\begin{array}{c} 
    \partial f(x) &=& \{ y\in\mathbb R^n \,|\, f^{\star}(y) \,=\, \langle x,y\rangle - f(x)\}, 
\end{array}\] which is a convenient characterisation.</p>
<p><strong>Example</strong>: we can consider a simple &#40;and yet quite useful&#41; example for the convex conjugate: if we define \(\psi(x):=\|x\|^2/2\), its convex conjugate is then</p>
\[
    \psi^\star(y) \quad\!\! =\quad\!\! \sup_{z}\,\, \langle z,y\rangle - \frac12\langle z,z\rangle.
\]
<p>The problem in the right hand side is easy to solve: the objective function is differentiable and the FOC gives \(y-z^\sharp = 0\) so that \(\psi^\star(y)= \psi(y)\).</p>
<p>Another nice example is \(f(x)=x\log(x)\), it&#39;s an easy exercise to show that \(f^\star(y)=\exp(y-1)\) and \(f^{\star\star}(x) = f(x)\).</p>
<h3><a id="fenchels-inequality-and-the-fenchel-moreau-theorem" href="#fenchels-inequality-and-the-fenchel-moreau-theorem">Fenchel&#39;s inequality and the Fenchel-Moreau theorem</a></h3>
<div class="colbox-blue">Let \(f:C\to \overline{\mathbb R}\) and \(f^\star\) its convex conjugate, then: \[\begin{array}{c} 
    f(x) + f^\star(y) &\ge & \langle x,y\rangle, \quad \forall x\in C,y\in \mathbb R^n.
\end{array}\] This is known as <em>Fenchel&#39;s inequality</em>.</div>

<p>This inequality is directly implied by the definition of the convex conjugate.</p>
<div class="colbox-blue">Let \(f\in \Gamma_0(C)\) then \(f^{\star\star}\equiv f\) on \(C\). This is known as the <em>Fenchel-Moreau theorem</em> &#40;FMT&#41;.</div>

<p>Proving the theorem in full generality requires a bit of care &#40;see references&#41;. It is however possible to show that the result holds on \(C^\circ\) without extra results which is nice. We will go about it in two parts:</p>
<ol>
<li><p>show that \(f(z)\ge f^{\star\star}(z)\) for all \(z\in C\),</p>
</li>
<li><p>show that \(f(z)\le f^{\star\star}(z)\) for all \(z\in C^\circ\).</p>
</li>
</ol>
<h4><a id="fmt-pt1" href="#fmt-pt1">FMT &#40;pt.1&#41;</a></h4>
<p>By definition of the convex conjugate, <a id="def-fstarstar"></a>\[
    f^{\star\star}(z) \quad\!\! =\quad\!\! \sup_{y\in\mathbb R^n} \left\langle z,y\right\rangle-f^\star(y) 
\] but since \(-f^\star(y)=\inf_{x\in C} [f(x)-\left\langle x,y\right\rangle]\), we have that for any \(y\) and \(z\), \[\begin{array}{c} 
    \left\langle z,y\right\rangle - f^\star(y) &\le& \left\langle z-x,y\right\rangle + f(x), \quad\forall x\in C.
\end{array}\] In particular, for any \(z\in C\), we can take \(x=z\) so that \(f^{\star\star}(z) \le f(z)\) on \(C\).</p>
<h4><a id="fmt-pt2" href="#fmt-pt2">FMT &#40;pt.2&#41;</a></h4>
<p>Starting again from <span class="eqref">(<a href="#def-fstarstar">8</a>)</span>, we can write \[\begin{array}{c} 
    f^{\star\star}(z) &\ge& \left\langle z,y\right\rangle - f^\star(y), \quad \forall y \in\mathbb R^n.
\end{array}\] If we now consider a \(x\in C^\circ\), we know that \(\partial f(x)\) is non-empty and so can pick \(y\in \partial f(x)\). But for such a \(y\) using the characterisation of the subdifferential <span class="eqref">(<a href="#def-subdiff-2">5</a>)</span> we can write \[\begin{array}{c} 
    f^\star(y) &=& \left\langle x, y\right\rangle - f(x)
\end{array}\] so that \(f^{\star\star}(z) \ge \left\langle z-x, y\right\rangle + f(x)\). For \(z\in C^\circ\) we can pick \(x=z\) and get \(f^{\star\star}(z)\ge f(z)\).</p>
<h2><a id="subdifferential-of-the-convex-conjugate" href="#subdifferential-of-the-convex-conjugate">Subdifferential of the convex conjugate</a></h2>
<p>Consider the definition of the subdifferential <span class="eqref">(<a href="#def-subdiff-2">5</a>)</span>, for any \(x\in C\) with \(y\in \partial(x)\) we have \[\begin{array}{c} 
    (x\in C, y\in\partial f(x)) &\Longleftrightarrow& f^\star(y)=\left\langle x, y\right\rangle-f(x).
\end{array}\] With exactly the same definition, we have for \(x\in\partial f^\star(y)\) \[\begin{array}{c} 
    x\in\partial f^\star(y) &\Longleftrightarrow& f^{\star\star}(x)=\left\langle x, y\right\rangle-f^\star(y),
\end{array}\] and the last equality can be rearranged to \(f^\star(y)=\left\langle x,y\right\rangle-f^{\star\star}(x)\). In the case where \(f\in\Gamma_0(C)\) then \(f\equiv f^{\star\star}\) on \(C\) by the Fenchel-Moreau theorem which gives the result that follows.</p>
<div class="colbox-blue">Let \(f\in\Gamma_0(C)\) then the following equivalence holds <a id="equiv-1"></a>\[\begin{array}{c} 
    (x\in C, y \in \partial f(x)) &\Longleftrightarrow& x \in \partial f^\star(y) \cap C. 
\end{array}\] Such a pair of point is called a <em>dual pair</em> and verifies \(f(x)+f^\star(y)=\left\langle x,y\right\rangle\).</div>

<p>Using the inverse of the subdifferential operator on the left hand side of <span class="eqref">(<a href="#equiv-1">14</a>)</span>, we have that \(x\in(\partial f)^{-1}(y)\cap C\) is equivalent to \(x\in\partial f^\star(y)\cap C\) which exposes a close link between \((\partial f)^{-1}\) and \(\partial f^\star\). This link becomes even more apparent in the unconstrained case.</p>
<div class="colbox-blue">Let \(f\in\Gamma_0(\mathbb R^n)\), then \[\begin{array}{c} 
    (\partial f)^{-1} &\equiv & \partial f^\star.
\end{array}\]</div>

<p><strong>Note</strong>: recall that, with the first order condition, a minimiser \(x^\dagger\) is such that \(0\in \partial f(x^\dagger)\) or \((\partial f)^{-1}(0) \ni x^\dagger\). We can now also write this \(x^\dagger \in \partial f^\star(0)\), thereby expressing the minimiser in terms of the convex-conjugate. Of course it&#39;s not clear at this point whether this helps at all to find the minimiser but, as it turns out, it will.</p>
<p><strong>Example</strong>: let&#39;s consider \(f(x)=x\log(x)\) on \(C = [0, 1]\). We know that \(f^\star(y)=\exp(y-1)\). Both \(f\) and \(f^\star\) are differentiable so \(\partial f(x)=\{\nabla f(x)\}\) with \(\nabla f(x)=\log x +1\) on \(C\) and \(\partial f^\star(y)=\{\nabla f^\star(y)\}\) with \(\nabla f^\star(y)=\exp(y-1)\) on \(\mathbb R\).</p>
<p>Gathering the pieces, if we take \(x\in C\) and \(y=\nabla f(x)\), we have \[\begin{array}{c} 
    y \,=\,\log x+1 &\Longrightarrow& x \,=\,\exp(y-1) \,=\,\nabla f^\star(y)
\end{array}\] and conversely if we consider a \(y\) such that \(\exp(y-1)\in C\) then \[\begin{array}{c} 
    x \,=\,\exp(y-1) &\Longrightarrow& y \,=\,\log x + 1 \,=\,\nabla f(x)
\end{array}\] So that the equivalence <span class="eqref">(<a href="#equiv-1">14</a>)</span> holds as expected.</p>
<h2><a id="additional-references" href="#additional-references">Additional references</a></h2>
<p><strong>Note</strong>: in this page &#40;and also further&#41; we usually consider \(C^\circ\) instead of  \(C\) to make the presentation simpler since we know that on \(C^\circ\), subgradients exist and are bounded. Of course this is done at the expense of generality and some care is needed to generalise properly but the extra details did not seem particularly relevant at the level of this presentation. The references listed typically show the results in their full glory.</p>
<ol>
<li><p><strong>Hiriart-Urruty</strong>, <a href="https://www.math.univ-toulouse.fr/~jbhu/A_note_on_the_LF_transform.pdf">A note on the Legendre-Fenchel transform of convex composite functions</a>, 2006. – This is a more technical note that you may find interesting if you would like more details on convex conjugacy.</p>
</li>
<li><p><strong>Mete Soner</strong>, <a href="https://www2.math.ethz.ch/education/bachelor/lectures/hs2015/math/mf/lecture7notes">Convex analysis and Fenchel-Moreau theorem</a>, 2015. – Lecture notes covering convex conjugacy in more depth and proving rigorously the Fenchel-Moreau theorem.</p>
</li>
</ol>
<p><em>See also the general references mentioned in the <a href="/pub/csml/cvxopt/intro.html">introduction</a>.</em>
<div class="page-foot">
		<div class="copyright">
				&copy; T. Lienart. Last modified: December 14, 2018. Website built with <a href="https://github.com/tlienart/JuDoc.jl">JuDoc.jl</a>.
		</div>
</div>

</div>
<!-- CONTENT ENDS HERE -->
        
                <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

        
        
    </body>
</html>
