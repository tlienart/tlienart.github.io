<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/css/main.css"> <link rel=icon  href="/assets/infra/favicon.png"> <title>Approximate Bayesian Inference - Introduction</title> <header> <div class=blog-name ><a href="/">Thibaut Lienart</a></div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/pub/csml.html">CS/ML notes</a> <li><a href="/pub/julia.html">Julia notes</a> </ul> <img src="/assets/infra/hamburger.svg" id=menu-icon > </nav> </header> <div class=jd-content > <h1>Introduction to Approximate Bayesian Inference</h1> <p>In <em>Bayesian Machine Learning</em> &#40;BML&#41;, one is broadly interested in recovering a posterior distribution over the parameters <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> &#40;with typically <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=script >X</mi><mo>⊆</mo><msup><mi mathvariant=double-struck >R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">x\in\mathcal X\subseteq \mathbb R^d</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⊆</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.849108em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbb">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span> &#41; of some parametric model of interest for which we have a likelihood <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant=script >D</mi><mi mathvariant=normal >∣</mi><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathcal D|x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class=mord >∣</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span></span> &#40;where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >D</mi></mrow><annotation encoding="application/x-tex">\mathcal D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span> denotes the data&#41; using Bayes&#39; trick:</p> <a id=e2CA ></a> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mi mathvariant=normal >∣</mi><mi mathvariant=script >D</mi><mo>)</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>∝</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi>p</mi><mo>(</mo><mi mathvariant=script >D</mi><mi mathvariant=normal >∣</mi><mi>x</mi><mo>)</mo><mi>p</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> p(x|\mathcal D) \quad\!\! \propto\quad\!\! p(\mathcal D|x)p(\theta). </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mord >∣</span><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >∝</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class=mord >∣</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span><span class=mord >.</span></span></span></span></span> <p>In equation <span class=eqref >(<a href="#e2CA">1</a>)</span>, <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span></span> denotes our <em>prior</em> belief on what the parameters should be and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mi mathvariant=normal >∣</mi><mi mathvariant=script >D</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(x|\mathcal D)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mord >∣</span><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class=mclose >)</span></span></span></span> is the <em>posterior distribution</em> over <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> . The posterior is then used to make more robust predictions with the model and, in particular, to account for <strong>uncertainty</strong> in the model parameters.</p> <p>This approach is optimal under two key assumptions:</p> <ol> <li><p>the prior is chosen appropriately,</p> <li><p>the posterior is tractable &#40;or at least we can sample from it&#41;.</p> </ol> <p>The first assumption is usually overlooked by researchers in computational Bayesian statistics who usually assume the prior is given &#40;and, in practice, it typically encodes a regularisation&#41;. This is not without its weaknesses but it would require an entire set of notes to be discussed appropriately. The second assumption is generally far from true especially with complex models and many approaches have been suggested such as MCMC methods; while these can do very well when <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> is low-dimensional, they typically struggle when the dimensionality is high.</p> <p>In these notes we define <em>Approximate Bayesian Inference</em> &#40;ABI&#41; in broad terms as the class of methods attempting to recover a distribution <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> such that <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> is a good <em>proxy</em> for the posterior distribution of interest <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> . A number of such methods are commonly used when the dimensionality of the problem makes MCMC-like methods computationally too expensive.</p> <h2>Variational problem</h2> <p>In what follows we simplify the context a little bit by considering methods which find good proxy <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> to some target distribution <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> . We write <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >F</mi><mo>⊂</mo><mi mathvariant=script >P</mi><mo>(</mo><mi mathvariant=script >X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal F\mathcal \subset \mathcal P(\mathcal X)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathcal" style="margin-right:0.09931em;">F</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⊂</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class=mopen >(</span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mclose >)</span></span></span></span> the space of candidate proxy distributions where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >P</mi><mo>(</mo><mi mathvariant=script >X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal P(\mathcal X)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class=mopen >(</span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mclose >)</span></span></span></span> designates all probability distributions on <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >X</mi></mrow><annotation encoding="application/x-tex">\mathcal X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span> .</p> <p>Let <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>D</mi><mo>:</mo><mi mathvariant=script >P</mi><mo>(</mo><mi mathvariant=script >X</mi><mo>)</mo><mo>×</mo><mi mathvariant=script >P</mi><mo>(</mo><mi mathvariant=script >X</mi><mo>)</mo><mo>↦</mo><msub><mi mathvariant=double-struck >R</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">D:\mathcal P(\mathcal X)\times \mathcal P(\mathcal X) \mapsto \mathbb R_+</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class=mopen >(</span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class=mopen >(</span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.897221em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathbb">R</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> denote a discrepancy measure between two probability distribution functions. Then, the generic variational problem considered in ABI is the minimisation of this <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> between the candidate <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi><mo>∈</mo><mi mathvariant=script >F</mi></mrow><annotation encoding="application/x-tex">q\in \mathcal F</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span> and the target <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> :</p> <a id=Wto9 ></a> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msup><mi>q</mi><mo>⋆</mo></msup><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>∈</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi>arg</mi><mo>⁡</mo><munder><mi>min</mi><mo>⁡</mo><mrow><mi>q</mi><mo>∈</mo><mi mathvariant=script >F</mi></mrow></munder><mi>D</mi><mo>(</mo><mi>q</mi><mo separator=true >,</mo><mi>p</mi><mo>)</mo><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> q^\star \quad\!\! \in\quad\!\! \arg\min_{q\in\mathcal F} D(q, p). </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.933136em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">⋆</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1.630439em;vertical-align:-0.880439em;"></span><span class=mop >ar<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.0556690000000004em;margin-left:0em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.09931em;">F</span></span></span></span><span style="top:-2.7em;"><span class=pstrut  style="height:2.7em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.880439em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class=mclose >)</span><span class=mord >.</span></span></span></span></span> <p>Techniques attempting to solve such problems rely upon exploiting at least one of the following three main characteristics:</p> <ol> <li><p>the definition of the discrepancy measure <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span> &#40;aka. divergence&#41;,</p> <li><p>the definition of the restricted set of probability distributions <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >F</mi></mrow><annotation encoding="application/x-tex">\mathcal F</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span> ,</p> <li><p>the structure of the target distribution <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> .</p> </ol> <p>Many discrepancy measures can be considered such as the total variation distance, Wasserstein distances or <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> -divergences. However, most of these choices can lead to the corresponding problem <span class=eqref >(<a href="#Wto9">2</a>)</span> being computationally &#40;very&#41; expensive to solve in general, especially if the space <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >X</mi></mrow><annotation encoding="application/x-tex">\mathcal X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span> is continuous.</p> <p>In these notes we will focus on the Kullback-Leibler &#40;KL&#41; divergence which, as we&#39;ll see, can lead to optimisation problems for which efficient computational methods exist. As a reminder, the KL divergence between two distributions <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> is defined as</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><mrow><mi mathvariant=normal >K</mi><mi mathvariant=normal >L</mi></mrow><mo>(</mo><mi>p</mi><mo separator=true >,</mo><mi>q</mi><mo>)</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mi>p</mi></msub><mo>[</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo>(</mo><mi>X</mi><mo>)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>q</mi><mo>(</mo><mi>X</mi><mo>)</mo><mo>]</mo><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \mathrm{KL}(p, q) \quad\!\! =\quad\!\! \mathbb E_p[\log p(X) - \log q(X)]. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">K</span><span class="mord mathrm">L</span></span><span class=mopen >(</span><span class="mord mathdefault">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mclose >]</span><span class=mord >.</span></span></span></span></span> <p>We will look at both <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mrow><mi mathvariant=normal >K</mi><mi mathvariant=normal >L</mi></mrow><mo>(</mo><mi>p</mi><mo separator=true >,</mo><mi>q</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm{KL}(p, q)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">K</span><span class="mord mathrm">L</span></span><span class=mopen >(</span><span class="mord mathdefault">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mrow><mi mathvariant=normal >K</mi><mi mathvariant=normal >L</mi></mrow><mo>(</mo><mi>q</mi><mo separator=true >,</mo><mi>p</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm{KL}(q, p)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">K</span><span class="mord mathrm">L</span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class=mclose >)</span></span></span></span> and, while in both case <span class=eqref >(<a href="#Wto9">2</a>)</span> is intractable, in both cases proxy problems can be obtained and lead to two well known algorithms &#40;along with related variants&#41;:</p> <ul> <li><p>the &#40;Mean-Field&#41; Variational Bayes algorithm &#40;&#40;MF&#41;VB&#41;, which we will discuss <a href="/pub/csml/abi/vb.html">here</a>,</p> <li><p>the Expectation Propagation algorithm &#40;EP&#41;, which we will discuss <a href="/pub/csml/abi/ep.html">here</a>.</p> </ul> <h2>A warning note</h2> <p>At the risk of stating the obvious, it must stressed that ABI algorithms do in general <em>not lead to the correct posterior</em> but rather to a proxy which may be a very poor approximation to the target posterior. Therefore, no matter what ABI algorithm you use, you should in general be very careful about how you interpret the recovered proxy <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> and should ideally refrain from making strong statements about the uncertainty in the model parameters based upon <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> unless you&#39;ve tested it somehow.</p> <p>While there are some cases where ABI algorithms can give good proxy &#40;in particular if <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> is known to be log-concave and thin-tailed&#41;, in many circumstances, and especially in the context of complex/high-dimensional models such as neural networks, ABI algorithms lead to proxy distributions which may</p> <ul> <li><p>typically recover reasonable location &#40;e.g. the most likely <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> according to the proxy <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> is a good parameter for the model in terms of generalisation error&#41;</p> <li><p>typically recover appalling uncertainty &#40;often catastrophically underestimated&#41;.</p> </ul> <p>ABI is a nice theoretical field with interesting mathematical tools but that should not prevent you from checking that the results obtained are sensible. If you are not in a position to check the validity of the obtained proxy, you should probably revert to simply considering the maximum a posteriori &#40;MAP&#41; and avoid fooling yourself into thinking that you have a workable model of the uncertainty. <div class=page-foot > <div class=copyright > &copy; T. Lienart. Last modified: March 26, 2019. Website built with <a href="https://github.com/tlienart/JuDoc.jl">JuDoc.jl</a>. </div> </div> </div>