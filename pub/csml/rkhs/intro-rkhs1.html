<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/css/main.css"> <link rel=icon  href="/assets/infra/favicon.png"> <title>RKHS Embeddings</title> <header> <div class=blog-name ><a href="/">Thibaut Lienart</a></div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/pub/csml.html">CS/ML notes</a> <li><a href="/pub/julia.html">Julia notes</a> </ul> <img src="/assets/infra/hamburger.svg" id=menu-icon > </nav> </header> <div class=jd-content > <h2><a id=introduction  href="#introduction">Introduction</a></h2> <p>These notes were prepared with help from <a href="http://www.stats.ox.ac.uk/~sejdinov/">Dino Sejdinovic</a> for a talk to a <em>kernel methods reading group</em> given in Oxford in July 2015. The notes are fairly dry, I intend to come back and add more comments on the intuition in the future &#40;in particular for the second part&#41;.</p> <h3><a id=basic-definitions  href="#basic-definitions">Basic definitions</a></h3> <div class=colbox-blue >A Hilbert space <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">\mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> of functions <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>f</mi><mo>:</mo><mi mathvariant=script >X</mi><mo>↦</mo><mi mathvariant=double-struck >R</mi></mrow><annotation encoding="application/x-tex">f:\mathcal X\mapsto \mathbb R</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69433em;vertical-align:-0.011em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span> defined on a non-empty set <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >X</mi></mrow><annotation encoding="application/x-tex">\mathcal X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span> is said to be a <em>reproducing kernel Hilbert space</em> &#40;RKHS&#41; if <em>evaluation functionals</em> <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>δ</mi><mi>x</mi></msub><mo>:</mo><mi>f</mi><mo>↦</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\delta_x: f\mapsto f(x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span></span> are continuous for all <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=script >X</mi></mrow><annotation encoding="application/x-tex">x\in\mathcal X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span> </div> <p>If we consider a RKHS then, by Riesz&#39;s representation theorem, since <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>δ</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\delta_x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a continuous functional, it has a <em>representer</em> in <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">\mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> that we can denote <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>k</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">k_{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> such that</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mrow><mo fence=true >⟨</mo><mi>f</mi><mo separator=true >,</mo><msub><mi>k</mi><mi>x</mi></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi>δ</mi><mi>x</mi></msub><mo>(</mo><mi>f</mi><mo>)</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \left\langle f, k_{x}\right\rangle_{\mathcal H} &amp;=&amp; \delta_x(f) \quad\!\! =\quad\!\! f(x). \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29969999999999997em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <p>We can then define a &#40;positive-definite&#41; bilinear form <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi><mo>:</mo><mi mathvariant=script >X</mi><mo>×</mo><mi mathvariant=script >X</mi><mo>→</mo><mi mathvariant=double-struck >R</mi></mrow><annotation encoding="application/x-tex">k:\mathcal X\times\mathcal X \to \mathbb R</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">R</span></span></span></span> as <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi><mo>(</mo><mi>x</mi><mo separator=true >,</mo><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup><mo>)</mo><mo>:</mo><mo>=</mo><msub><mrow><mo fence=true >⟨</mo><msub><mi>k</mi><mi>x</mi></msub><mo separator=true >,</mo><msub><mi>k</mi><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mrow><annotation encoding="application/x-tex">k(x, x&#x27;):=\left\langle k_{x}, k_{x&#x27;}\right\rangle_{\mathcal H}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0497em;vertical-align:-0.29969999999999997em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29969999999999997em;"><span></span></span></span></span></span></span></span></span></span> . This is known as the <strong>reproducing kernel</strong> of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">\mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> ; we will also write <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>k</mi><mi>x</mi></msub><mo>=</mo><mi>k</mi><mo>(</mo><mo>⋅</mo><mo separator=true >,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">k_{x} = k(\cdot, x)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord >⋅</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span></span> .</p> <p>There&#39;s then an important theorem that links the two &#40;and that we won&#39;t prove&#41; reproduced in a simplified form below:</p> <div class=colbox-blue >&#40;<strong>Moore-Aronszajn</strong>&#41; Every positive-definite bilinear form <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> is a reproducing kernel for some Hilbert space <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >H</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal H_k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> .</div> <p>When the kernel is clear from the context, we will simply write <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">\mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> for the RKHS and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> for its reproducing kernel.</p> <h2><a id=kernel-embedding-of-a-distribution  href="#kernel-embedding-of-a-distribution">Kernel embedding of a distribution</a></h2> <p>A classical way to try to represent points in a given space <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >X</mi></mrow><annotation encoding="application/x-tex">\mathcal X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span> is to <em>embed</em> them in <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msup><mi mathvariant=double-struck >R</mi><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb R^s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbb">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span></span></span></span> using a <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span> -dimensional <em>feature map</em> <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=normal >Φ</mi><mo>:</mo><mi mathvariant=script >X</mi><mo>→</mo><msup><mi mathvariant=double-struck >R</mi><mi>s</mi></msup></mrow><annotation encoding="application/x-tex">\Phi:\mathcal X\to \mathbb R^s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Φ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.14643em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbb">R</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span></span></span></span> with <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>x</mi><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>↦</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi mathvariant=normal >Φ</mi><mo>(</mo><mi>x</mi><mo>)</mo><mtext> </mtext><mtext> </mtext><mo>=</mo><mtext> </mtext><mtext> </mtext><mo>(</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo separator=true >,</mo><msub><mi>φ</mi><mn>2</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>φ</mi><mi>s</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} x\quad\!\!\mapsto\quad\!\!\Phi(x)\,\,=\,\, (\varphi_1(x), \varphi_2(x), \dots, \varphi_s(x)). \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord >Φ</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mclose >)</span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> Instead, we can now consider embedding points in a RKHS with the infinite dimensional feature map <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi><mo>↦</mo><msub><mi>k</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">x\mapsto k_{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.522em;vertical-align:-0.011em;"></span><span class="mord mathdefault">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> . In that case, we have an easily computable inner product between points with</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mrow><mo fence=true >⟨</mo><msub><mi>k</mi><mi>x</mi></msub><mo separator=true >,</mo><msub><mi>k</mi><mi>y</mi></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mrow><mo fence=true >⟨</mo><mi>k</mi><mo>(</mo><mo>⋅</mo><mo separator=true >,</mo><mi>x</mi><mo>)</mo><mo separator=true >,</mo><mi>k</mi><mo>(</mo><mo>⋅</mo><mo separator=true >,</mo><mi>y</mi><mo>)</mo><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi>k</mi><mo>(</mo><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo>)</mo><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \left\langle k_{x}, k_{y}\right\rangle_{\mathcal H} &amp;=&amp; \left\langle k(\cdot, x), k(\cdot, y)\right\rangle_{\mathcal H} \quad\!\! =\quad\!\! k(x, y). \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.14252299999999996em;"><span style="top:-2.364192em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.335808em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord >⋅</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord >⋅</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29969999999999997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <p>Recall that an inner product is a <em>measure of alignment</em> so that this automatically gives us a measure of similarity between points through this kernel.</p> <p>When the embedding is <em>injective</em> &#40;i.e.: different objects are mapped to different points in the RKHS&#41;, the corresponding kernel is said to be <em>characteristic</em> &#40;this is often the case for standard kernels&#41;.</p> <h3><a id=mean-embedding  href="#mean-embedding">Mean embedding</a></h3> <p>An example of objects we can embed in an RKHS are distributions. Each distribution is then considered as a point which we can embed through the <em>mean-embedding</em>.</p> <div class=colbox-blue >Let <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> denote a distribution among a set <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >P</mi><mo>(</mo><mi mathvariant=normal >Ω</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal P(\Omega)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class=mopen >(</span><span class=mord >Ω</span><span class=mclose >)</span></span></span></span> of distributions over some <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=normal >Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Ω</span></span></span></span> , the <strong>mean embedding</strong> is defined as follows:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>P</mi><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>↦</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi>μ</mi><mo>(</mo><mi>P</mi><mo separator=true >;</mo><mi>k</mi><mo>)</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>:</mo><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mrow><mi>X</mi><mo>∼</mo><mi>P</mi></mrow></msub><mo>[</mo><mi>k</mi><mo>(</mo><mo>⋅</mo><mo separator=true >,</mo><mi>X</mi><mo>)</mo><mo>]</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mrow><mi>X</mi><mo>∼</mo><mi>P</mi></mrow></msub><mo>[</mo><msub><mi>k</mi><msub><mrow></mrow><mi>X</mi></msub></msub><mo>]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} P \quad\!\! \mapsto\quad\!\! \mu(P; k) \quad\!\! :=\quad\!\! \mathbb E_{X\sim P}[k(\cdot, X)] \quad\!\! =\quad\!\! \mathbb E_{X\sim P}[k_{_X}],\end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class="mord mathdefault">μ</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >:</span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mrel mtight">∼</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord >⋅</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mrel mtight">∼</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> and, naturally, <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>μ</mi><mo>(</mo><mi>P</mi><mo separator=true >,</mo><mi>k</mi><mo>)</mo><mo>∈</mo><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">\mu(P, k)\in\mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> . When the kernel and distribution are clear from the context, we will simply write <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>μ</mi><mo>(</mo><mi>P</mi><mo separator=true >;</mo><mi>k</mi><mo>)</mo><mo>=</mo><mo>:</mo><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub></mrow><annotation encoding="application/x-tex">\mu(P; k)=:\mu_{_X}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">μ</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.680865em;vertical-align:-0.250305em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span></span></span></span> where, implicitly <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>X</mi><mo>∼</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">X\sim P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> .</div> <p>Observe that we now have this continuous embedding instead of a finite-dimensional embedding that we could have considered such as <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi><mo>↦</mo><mo>(</mo><mi mathvariant=double-struck >E</mi><mo>[</mo><msub><mi>φ</mi><mn>1</mn></msub><mo>(</mo><mi>X</mi><mo>)</mo><mo>]</mo><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><mi mathvariant=double-struck >E</mi><mo>[</mo><msub><mi>φ</mi><mi>s</mi></msub><mo>(</mo><mi>X</mi><mo>)</mo><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">P\mapsto (\mathbb E[\varphi_1(X)], \dots, \mathbb E[\varphi_s(X)])</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69433em;vertical-align:-0.011em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathbb">E</span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault">φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathbb">E</span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault">φ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mclose >]</span><span class=mclose >)</span></span></span></span> . Also, as before, we inherit a notion of <em>similarity</em> between points &#40;here probability distributions&#41; by considering the inner product on the RKHS: <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mrow><mo fence=true >⟨</mo><mi>μ</mi><mo>(</mo><mi>P</mi><mo separator=true >;</mo><mi>k</mi><mo>)</mo><mo separator=true >,</mo><mi>μ</mi><mo>(</mo><mi>Q</mi><mo separator=true >;</mo><mi>k</mi><mo>)</mo><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>[</mo><mi>k</mi><mo>(</mo><mi>X</mi><mo separator=true >,</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \left\langle \mu(P; k), \mu(Q; k)\right\rangle_{\mathcal H} \quad\!\! =\quad\!\! \mathbb E_{X Y}[k(X, Y)], \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault">μ</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">μ</span><span class=mopen >(</span><span class="mord mathdefault">Q</span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29969999999999997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> and this can easily be estimated if we have samples from both <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> .</p> <p>Note finally that <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub></mrow><annotation encoding="application/x-tex">\mu_{_X}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.680865em;vertical-align:-0.250305em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span></span></span></span> represents <em>expectations with respect to <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> /em> i.e.: for any <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>f</mi><mo>∈</mo><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">f\in\mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> , <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mrow><mo fence=true >⟨</mo><mi>f</mi><mo separator=true >,</mo><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=double-struck >E</mi><mi>X</mi></msub><mo>[</mo><msub><mrow><mo fence=true >⟨</mo><mi>f</mi><mo separator=true >,</mo><msub><mi>k</mi><msub><mrow></mrow><mi>X</mi></msub></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mo>]</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mi>X</mi></msub><mo>[</mo><mi>f</mi><mo>(</mo><mi>X</mi><mo>)</mo><mo>]</mo><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \left\langle f, \mu_{_X}\right\rangle_{\mathcal H} &amp;=&amp; \mathbb E_X[{\left\langle f, k_{_X}\right\rangle_{\mathcal H}}] \quad\!\! =\quad\!\! \mathbb E_X[f(X)] . \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17832599999999998em;"><span style="top:-2.399995em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.30000499999999997em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17832599999999998em;"><span style="top:-2.399995em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.30000499999999997em;"><span></span></span></span></span></span></span></span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mclose >]</span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <h3><a id=joint-embedding  href="#joint-embedding">Joint embedding</a></h3> <p>The generalisation to joint distributions is straightforward using tensor product feature spaces.</p> <div class=colbox-blue >Let <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>X</mi><mo separator=true >,</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X, Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> be jointly distributed according to some distribution <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> , the <strong>joint embedding</strong> of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> is defined as <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>P</mi><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>↦</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>(</mo><mi>P</mi><mo>)</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>:</mo><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>[</mo><msub><mi>k</mi><msub><mrow></mrow><mi>X</mi></msub></msub><mo>⊗</mo><msub><mi>k</mi><msub><mrow></mrow><mi>Y</mi></msub></msub><mo>]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} P \quad\!\! \mapsto\quad\!\! \mathcal C_{XY}(P) \quad\!\! :=\quad\!\! \mathbb E_{XY}[k_{_X}\otimes k_{_Y}], \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >↦</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >:</span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> assuming that the two variables share the same kernel.</div> <p>The tensor product satisfies <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mrow><mo fence=true >⟨</mo><msub><mi>k</mi><msub><mrow></mrow><mi>x</mi></msub></msub><mo>⊗</mo><msub><mi>k</mi><msub><mrow></mrow><mi>y</mi></msub></msub><mo separator=true >,</mo><msub><mi>k</mi><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup></msub><mo>⊗</mo><msub><mi>k</mi><msup><mi>y</mi><mo mathvariant=normal >′</mo></msup></msub><mo fence=true >⟩</mo></mrow><mrow><mi mathvariant=script >H</mi><mo>⊗</mo><mi mathvariant=script >H</mi></mrow></msub><mo>=</mo><mi>k</mi><mo>(</mo><mi>x</mi><mo separator=true >,</mo><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup><mo>)</mo><mi>k</mi><mo>(</mo><mi>y</mi><mo separator=true >,</mo><msup><mi>y</mi><mo mathvariant=normal >′</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\left\langle k_{_x} \otimes k_{_y}, k_{x&#x27;} \otimes k_{y&#x27;}\right\rangle_{\mathcal H\otimes \mathcal H} = k(x, x&#x27;)k(y, y&#x27;)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.308041em;vertical-align:-0.45804100000000003em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.03481999999999999em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.03481999999999996em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.34731999999999996em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32798em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07862099999999994em;"><span style="top:-2.30029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span><span class="mbin mtight">⊗</span><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.45804100000000003em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> .</p> <p>In the same way that <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub></mrow><annotation encoding="application/x-tex">\mu_{_X}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.680865em;vertical-align:-0.250305em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span></span></span></span> represents the expectation operator, the joint-embedding <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{XY}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> can be viewed as the <em>uncentered cross-covariance operator</em>: for any two functions <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>f</mi><mo separator=true >,</mo><mi>g</mi><mo>∈</mo><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">f, g \in \mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> , their uncentered covariance is given by</p> <a id=covariance-op-1 ></a> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=double-struck >E</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>[</mo><mi>f</mi><mo>(</mo><mi>X</mi><mo>)</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mrow><mo fence=true >⟨</mo><mi>f</mi><mo>⊗</mo><mi>g</mi><mo separator=true >,</mo><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo fence=true >⟩</mo></mrow><mrow><mi mathvariant=script >H</mi><mo>⊗</mo><mi mathvariant=script >H</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mrow><mo fence=true >⟨</mo><mi>f</mi><mo separator=true >,</mo><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>g</mi><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mathbb E_{XY}[f(X)g(Y)] &amp;=&amp; \left\langle f\otimes g, \mathcal C_{XY}\right\rangle_{\mathcal H\otimes \mathcal H} \quad\!\! =\quad\!\! \left\langle f, \mathcal C_{XY} g\right\rangle_{\mathcal H} \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span><span class="mbin mtight">⊗</span><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.358031em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29969999999999997em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <p>&#40;still assuming both random variables share the same kernel&#41;. Following the same reasoning, we can define the <em>auto-covariance operators</em> <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{XX}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi>Y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{YY}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> . Note also that, where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub></mrow><annotation encoding="application/x-tex">\mu_{_X}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.680865em;vertical-align:-0.250305em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span></span></span></span> represents expectations with respect to <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> &#40;the distribution of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> &#41;, these operators represent cross-covariance/auto-covariance with respect to <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> .</p> <p><strong>Remark</strong>: we have assumed that both random variables share the same kernel but this need not be the case: we can consider a second kernel <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msup><mi>k</mi><mo mathvariant=normal >′</mo></msup></mrow><annotation encoding="application/x-tex">k&#x27;</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> with a RKHS <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msup><mi mathvariant=script >H</mi><mo mathvariant=normal >′</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal H&#x27;</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> ; the cross-covariance operator then belongs to the product space <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >H</mi><mo>⊗</mo><msup><mi mathvariant=script >H</mi><mo mathvariant=normal >′</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal H\otimes \mathcal H&#x27;</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> &#40;which is also a RKHS&#41;.</p> <h3><a id=mmd-and-hsic  href="#mmd-and-hsic">MMD and HSIC</a></h3> <p>We have now seen two ways of embedding a distribution into a RKHS, now let&#39;s see why that can be useful. When considering a characteristic kernel &#40;such as, for example, the Gaussian RBF with <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi><mo>(</mo><mi>x</mi><mo separator=true >,</mo><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup><mo>)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo>(</mo><mo>−</mo><mi>σ</mi><mi mathvariant=normal >∥</mi><mi>x</mi><mo>−</mo><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup><msubsup><mi mathvariant=normal >∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">k(x, x&#x27;)=\exp(-\sigma\|x-x&#x27;\|^2_2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >exp</span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class=mord >∥</span><span class="mord mathdefault">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord >∥</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> &#41;, the RKHS embedding is <em>injective</em>. In that case, we can use the distance in the RKHS &#40;induced by the inner-product&#41; as a proxy for similarity in the distribution space. This can be used in the two-sample test &#40;to see whether two random variables are distributed according to the same distribution&#41; or when testing for independence between random variables.</p> <p>In the <em>kernel two sample test</em> <span class=bibref >(<a href="#gretton12a">Gretton et al. (2012a)</a>)</span>, the test statistic is the squared distance between the embeddings of the two distributions:</p> <div class=colbox-blue >The kernel <strong>Maximum Mean Discrepancy</strong> &#40;<strong>MMD</strong>&#41; measure is defined for two distributions <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> by <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=normal >M</mi><mi mathvariant=normal >M</mi><mi mathvariant=normal >D</mi></mrow><mo>(</mo><mi>P</mi><mo separator=true >,</mo><mi>Q</mi><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo>:</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi mathvariant=normal >∥</mi><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub><mo>−</mo><msub><mi>μ</mi><msub><mrow></mrow><mi>Y</mi></msub></msub><msubsup><mi mathvariant=normal >∥</mi><mi mathvariant=script >H</mi><mn>2</mn></msubsup><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mathrm{MMD}(P, Q) &amp;:=&amp; \|\mu_{_X} - \mu_{_Y}\|_{\mathcal H}^2, \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">M</span><span class="mord mathrm">M</span><span class="mord mathrm">D</span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Q</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >:</span><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >∥</span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >∥</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.275331em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>X</mi><mo>∼</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">X\sim P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>Y</mi><mo>∼</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">Y\sim Q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> . </div> <p>It is then possible to study the asymptotic properties of both the MMD and the MMD² and build hypothesis tests at a given level, independently of the distributions considered &#40;see <span class=bibref ><a href="#gretton12a">Gretton et al. (2012a)</a></span> corollary 9 and 11&#41;.</p> <p>When testing for <em>independence</em>, the test statistic can be the squared distance between the embeddings of the joint distribution and the product of its marginals which leads to the <em>kernel independence test</em> <span class=bibref >(<a href="#gretton07">Gretton et al. (2007)</a>)</span>:</p> <div class=colbox-blue >The <strong>Hilbert-Schmidt Independence Criterion</strong> &#40;<strong>HSIC</strong>&#41; is defined for two distributions <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> by <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=normal >H</mi><mi mathvariant=normal >S</mi><mi mathvariant=normal >I</mi><mi mathvariant=normal >C</mi></mrow><mo>(</mo><mi>P</mi><mo separator=true >,</mo><mi>Q</mi><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo>:</mo><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi mathvariant=normal >∥</mi><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>−</mo><msub><mi>μ</mi><msub><mrow></mrow><mi>X</mi></msub></msub><mo>⊗</mo><msub><mi>μ</mi><msub><mrow></mrow><mi>Y</mi></msub></msub><msubsup><mi mathvariant=normal >∥</mi><mi mathvariant=script >H</mi><mn>2</mn></msubsup><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mathrm{HSIC}(P, Q) &amp;:=&amp; \|\mathcal C_{XY} - \mu_{_X} \otimes \mu_{_Y}\|_{\mathcal H}^2, \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">H</span><span class="mord mathrm">S</span><span class="mord mathrm">I</span><span class="mord mathrm">C</span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Q</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >:</span><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >∥</span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >∥</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.424669em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.275331em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>X</mi><mo>∼</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">X\sim P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>Y</mi><mo>∼</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">Y\sim Q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> .</div> <p>Again, it is then possible to study the asymptotic properties of the HSIC and build a hypothesis test at a given level, independently of the distributions considered &#40;cf. <span class=bibref >(<a href="#gretton07">Gretton et al. (2007)</a>)</span>&#41;.</p> <h3><a id=finite-sample-embeddings  href="#finite-sample-embeddings">Finite sample embeddings</a></h3> <p>All of the embeddings defined above can readily be estimated using samples drawn from the distributions of interest. Let <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mo>{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">\{x_1, \dots, x_n\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >{</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >}</span></span></span></span> be an iid. draw from <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> , the <em>empirical kernel embedding</em> is defined as</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mover accent=true ><mi>μ</mi><mo stretchy=true >^</mo></mover><msub><mrow></mrow><mi>X</mi></msub></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>:</mo><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>k</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \widehat{\mu}_{_X} \quad\!\! :=\quad\!\! n^{-1}\sum_{i=1}^n k_{x_i}. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.920865em;vertical-align:-0.250305em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.67056em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault">μ</span></span></span><span class=svg-align  style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:2.929066em;vertical-align:-1.277669em;"></span><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mord >.</span></span></span></span></span> <p>As for standard Monte Carlo estimators, the rate of convergence is <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=script >O</mi><mo>(</mo><mn>1</mn><mi mathvariant=normal >/</mi><msqrt><mi>n</mi></msqrt><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal O(1/\sqrt{n})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.05028em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class=mopen >(</span><span class=mord >1</span><span class=mord >/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8002800000000001em;"><span class=svg-align  style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord  style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class=pstrut  style="height:3em;"></span><span class=hide-tail  style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5, -10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8, -50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0, 35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5, -221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467 s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422 s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.23972em;"><span></span></span></span></span></span><span class=mclose >)</span></span></span></span> &#40;an hence does not depend upon the dimensionality of the underlying space&#41;. Similarly, for an iid draw of pairs <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mo>{</mo><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>y</mi><mn>1</mn></msub><mo>)</mo><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><mo>(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">\{(x_1,y_1), \dots, (x_n, y_n)\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >{</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mclose >}</span></span></span></span> , the <em>empirical covariance operator</em> is defined as</p> <a id=empirical-cxy ></a> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><msub><mover accent=true ><mi mathvariant=script >C</mi><mo stretchy=true >^</mo></mover><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>k</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>⊗</mo><msub><mi>k</mi><msub><mi>y</mi><mi>i</mi></msub></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=normal >Υ</mi><msup><mi mathvariant=normal >Φ</mi><mi>t</mi></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \widehat{\mathcal C}_{XY} \quad\!\!&amp;=\quad\!\! n^{-1}\sum_{i=1}^n k_{x_i} \otimes k_{y_i} \\ &amp;=\quad\!\! n^{-1}\Upsilon\Phi^t \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:4.7531740000000005em;vertical-align:-2.126587em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.6265870000000007em;"><span style="top:-4.626587000000001em;"><span class=pstrut  style="height:3.6513970000000002em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.92333em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span></span><span class=svg-align  style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span></span><span style="top:-2.1848100000000006em;"><span class=pstrut  style="height:3.6513970000000002em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.126587em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.6265870000000007em;"><span style="top:-4.626587000000001em;"><span class=pstrut  style="height:3.6513970000000002em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⊗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.1848100000000006em;"><span class=pstrut  style="height:3.6513970000000002em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord >Υ</span><span class=mord ><span class=mord >Φ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.126587em;"><span></span></span></span></span></span></span></span></span></span></span></span> where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=normal >Υ</mi><mo>:</mo><mo>=</mo><mo>(</mo><msub><mi>k</mi><msub><mi>x</mi><mn>1</mn></msub></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>k</mi><msub><mi>x</mi><mi>n</mi></msub></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\Upsilon := (k_{x_1}, \dots, k_{x_n})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Υ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0001em;vertical-align:-0.2501em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=normal >Φ</mi><mo>:</mo><mo>=</mo><mo>(</mo><msub><mi>k</mi><msub><mi>y</mi><mn>1</mn></msub></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>k</mi><msub><mi>y</mi><mi>n</mi></msub></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\Phi:=(k_{y_1}, \dots, k_{y_n})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Φ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> are the <em>feature matrices</em>.</p> <p>To conclude, it is straightforward to obtain empirical estimators for the MMD and HSIC criterion considering kernel elements <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>x</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">k(x_i, x_j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> , <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>y</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">k(y_i, y_j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>k</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>y</mi><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">k(x_i, y_j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> . In the case of the MMD for instance, one has:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><mover accent=true ><mrow><mi mathvariant=normal >M</mi><mi mathvariant=normal >M</mi><mi mathvariant=normal >D</mi></mrow><mo stretchy=true >^</mo></mover><mo>(</mo><mi>P</mi><mo separator=true >,</mo><mi>Q</mi><mo>)</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mfrac><mn>1</mn><msup><mi>n</mi><mn>2</mn></msup></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence=true >(</mo><mi>k</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>x</mi><mi>j</mi></msub><mo>)</mo><mo>+</mo><mi>k</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>y</mi><mi>j</mi></msub><mo>)</mo><mo>−</mo><mn>2</mn><mi>k</mi><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>y</mi><mi>j</mi></msub><mo>)</mo><mo fence=true >)</mo></mrow></mrow><annotation encoding="application/x-tex"> \widehat{\mathrm{MMD}}(P, Q) \quad\!\! =\quad\!\! {1\over n^{2}}\sum_{i,j=1}^n \left(k(x_{i},x_{j})+k(y_{i},y_{j})-2k(x_{i},y_{j})\right) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.17333em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.92333em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">M</span><span class="mord mathrm">M</span><span class="mord mathrm">D</span></span></span></span><span class=svg-align  style="top:-3.6833299999999998em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Q</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class=mord ><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >2</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span> <h2><a id=kernel-embeddings-of-conditional-distributions  href="#kernel-embeddings-of-conditional-distributions">Kernel embeddings of conditional distributions</a></h2> <h3><a id=pointwise-definition  href="#pointwise-definition">Pointwise definition</a></h3> <p>In line with the definitions presented earlier, the kernel embedding of a conditional distribution <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(Y|X)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span></span></span></span> is defined as</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>μ</mi><msub><mrow></mrow><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub><mo>[</mo><msub><mi>k</mi><msub><mrow></mrow><mi>Y</mi></msub></msub><mo>]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mu_{_{Y|x}} &amp;=&amp; \mathbb E_{Y|x}[k_{_Y}], \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.24864em;vertical-align:-0.3743200000000001em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8743199999999999em;"><span style="top:-3.03432em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.3499999999999996em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.40864em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3743200000000001em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8743199999999999em;"><span style="top:-3.03432em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3743200000000001em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8743199999999999em;"><span style="top:-3.03432em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.35em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.250305em;"><span></span></span></span></span></span></span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3743200000000001em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <p>and the conditional expectation of a function <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>g</mi><mo>∈</mo><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">g\in \mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> can be expressed as</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mrow><mo fence=true >⟨</mo><mi>g</mi><mo separator=true >,</mo><msub><mi>μ</mi><msub><mrow></mrow><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mathbb E_{Y|x}[g(Y)] &amp;=&amp; \left\langle g, \mu_{_{Y|x}}\right\rangle_{\mathcal H}. \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.3083399999999998em;vertical-align:-0.40417000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9041699999999998em;"><span style="top:-3.05417em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.40417000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9041699999999998em;"><span style="top:-3.05417em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.40417000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9041699999999998em;"><span style="top:-3.05417em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.3499999999999996em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.40864em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.01999099999999998em;"><span style="top:-2.2416600000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.45833999999999997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.40417000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <p>Note that we now have a family of points in the RKHS indexed by <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> , the value upon which we condition.</p> <h3><a id=conditional-operator  href="#conditional-operator">Conditional operator</a></h3> <p>We can also define an operator <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{Y|X}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> such that</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>μ</mi><msub><mrow></mrow><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><msub><mi>k</mi><mi>x</mi></msub><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mu_{_{Y|x}} &amp;=&amp; \mathcal C_{Y|X} k_x.\end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.24864em;vertical-align:-0.3743200000000001em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8743199999999999em;"><span style="top:-3.03432em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.09136em;"><span style="top:-2.3499999999999996em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.40864em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3743200000000001em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8743199999999999em;"><span style="top:-3.03432em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3743200000000001em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8743199999999999em;"><span style="top:-3.03432em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3743200000000001em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> <p>To do so, we must first introduce a result for which we will provide a partial proof &#40;the full proof can be found in <span class=bibref ><a href="#fukumizu04">Fukumizu et al. (2004)</a></span>&#41;.</p> <div class=colbox-blue >The following identity holds &#40;under mild technical conditions&#41;:</p> <a id=identity-cxx-cxy ></a> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>g</mi><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \mathcal C_{XX} \mathbb E_{Y|X}[g(Y)] &amp;=&amp; \mathcal C_{XY}g. \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> </div> <p>To prove this, note that for <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>f</mi><mo>∈</mo><mi mathvariant=script >H</mi></mrow><annotation encoding="application/x-tex">f \in \mathcal H</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span> , using the definition of the joint embedding, we have</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><msub><mrow><mo fence=true >⟨</mo><mi>f</mi><mo separator=true >,</mo><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mi>X</mi></msub><mo>[</mo><mi>f</mi><mo>(</mo><mi>X</mi><mo>)</mo><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo>]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mi>X</mi></msub><mo>[</mo><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mo>[</mo><mi>f</mi><mo>(</mo><mi>X</mi><mo>)</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo>]</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=double-struck >E</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mo>[</mo><mi>f</mi><mo>(</mo><mi>X</mi><mo>)</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \left\langle f, \mathcal C_{XX} \mathbb E_{Y|X}[g(Y)]\right\rangle_{\mathcal H} \quad\!\! &amp;=\quad\!\! \mathbb E_X[f(X)\mathbb E_{Y|X}[g(Y)]] \\ &amp;=\quad\!\! \mathbb E_X[\mathbb E_{Y|X}[f(X)g(Y)]] \quad\!\! =\quad\!\! \mathbb E_{XY}[f(X)g(Y)], \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.0549em;vertical-align:-1.27745em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.77745em;"><span style="top:-3.92745em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07343100000000002em;"><span style="top:-2.2951em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4048999999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span></span><span style="top:-2.38255em;"><span class=pstrut  style="height:3em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.27745em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.77745em;"><span style="top:-3.92745em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mclose >]</span></span></span><span style="top:-2.38255em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.27745em;"><span></span></span></span></span></span></span></span></span></span></span></span> where at the last equality, we used the tower property of expectations. Comparing with <span class=eqref >(<a href="#covariance-op-1">8</a>)</span> we get <span class=eqref >(<a href="#identity-cxx-cxy">17</a>)</span>.</p> <p>With this, we can show another nice identity. Using the definition of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>μ</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mu_{Y|x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7857599999999999em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> , we have <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mrow><mo fence=true >⟨</mo><mi>g</mi><mo separator=true >,</mo><msub><mi>μ</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mrow><mo fence=true >⟨</mo><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo separator=true >,</mo><msub><mi>k</mi><mi>x</mi></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \left\langle g, \mu_{Y|x}\right\rangle_{\mathcal H} &amp;=&amp; \mathbb E_{Y|x}[g(Y)] \quad\!\! =\quad\!\! \left\langle \mathbb E_{Y|X}[g(Y)], k_x\right\rangle_{\mathcal H}. \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2549em;vertical-align:-0.37744999999999995em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.87745em;"><span style="top:-3.02745em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07343100000000002em;"><span style="top:-2.2951em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4048999999999999em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.37744999999999995em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.87745em;"><span style="top:-3.02745em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.37744999999999995em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.87745em;"><span style="top:-3.02745em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07343100000000002em;"><span style="top:-2.2951em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4048999999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.37744999999999995em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> But, using <span class=eqref >(<a href="#identity-cxx-cxy">17</a>)</span>, we have <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mtable><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mrow><mo fence=true >⟨</mo><msub><mi mathvariant=double-struck >E</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mo>[</mo><mi>g</mi><mo>(</mo><mi>Y</mi><mo>)</mo><mo>]</mo><mo separator=true >,</mo><msub><mi>k</mi><mi>x</mi></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><msub><mrow><mo fence=true >⟨</mo><msubsup><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub><mi>g</mi><mo separator=true >,</mo><msub><mi>k</mi><mi>x</mi></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mrow><mo fence=true >⟨</mo><mi>g</mi><mo separator=true >,</mo><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi>X</mi></mrow></msub><msubsup><mi>C</mi><mrow><mi>X</mi><mi>X</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>k</mi><mi>x</mi></msub><mo fence=true >⟩</mo></mrow><mi mathvariant=script >H</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{c} \left\langle \mathbb E_{Y|X}[g(Y)], k_x\right\rangle_{\mathcal H} &amp;=&amp; \left\langle \mathcal C_{XX}^{-1}\mathcal C_{XY} g, k_x\right\rangle_{\mathcal H} \quad\!\! =\quad\!\! \left\langle g, \mathcal C_{YX}C_{XX}^{-1} k_x\right\rangle_{\mathcal H} \end{array}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2591389999999998em;vertical-align:-0.3795695em;"></span><span class=mord ><span class=mtable ><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8795694999999998em;"><span style="top:-3.0253305em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class=mord ><span class="mord mathbb">E</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class=mclose >)</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07343100000000002em;"><span style="top:-2.2951em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.4048999999999999em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3795695em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8795694999999998em;"><span style="top:-3.0253305em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mrel >=</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3795695em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8795694999999998em;"><span style="top:-3.0253305em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.854239em;"><span style="top:-2.4064690000000004em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.293531em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07862099999999994em;"><span style="top:-2.3002900000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.39971em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.854239em;"><span style="top:-2.4064690000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.293531em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.07862099999999994em;"><span style="top:-2.3002900000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.39971em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3795695em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span></span></span></span></span></span></span> where at the last equality we took the adjoint of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msubsup><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>Y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{XX}^{-1}\mathcal C_{XY}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.14777em;vertical-align:-0.293531em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.854239em;"><span style="top:-2.4064690000000004em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.293531em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> which allows us to introduce the definition that follows.</p> <div class=colbox-blue >The <strong>conditional embedding operator</strong> is defined as <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>:</mo><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi>X</mi></mrow></msub><msubsup><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \mathcal C_{Y|X} \quad\!\! :=\quad\!\! \mathcal C_{YX}\mathcal C_{XX}^{-1}. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1.14777em;vertical-align:-0.28366199999999997em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.416338em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.28366199999999997em;"><span></span></span></span></span></span></span><span class=mord >.</span></span></span></span></span> </div> <p>In practice, <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{XX}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a <em>compact operator</em> which means that its eigenvalues go to zero and hence its inverse is not a bounded operator. So the definition of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{Y|X}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> given above is a slight abuse of notation. The inversion of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{XX}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> can be replaced by the <em>regularised inverse</em> <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mo>(</mo><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mo>+</mo><mi>λ</mi><mi>I</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(\mathcal C_{XX}+\lambda I)^{-1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> is a positive factor that can be determined by cross-validation.</p> <h3><a id=finite-sample-kernel-estimator  href="#finite-sample-kernel-estimator">Finite sample kernel estimator</a></h3> <p>If we consider an iid draw <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mo>{</mo><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><msubsup><mo>}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">\{(x_i, y_i)\}_{i=1}^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.008664em;vertical-align:-0.258664em;"></span><span class=mopen >{</span><span class=mopen >(</span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mclose ><span class=mclose >}</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span> from a joint distribution <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> , we know that the empirical estimators for <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>Y</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{YX}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi mathvariant=script >C</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal C_{XX}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> can be written as</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mover accent=true ><mi mathvariant=script >C</mi><mo stretchy=true >^</mo></mover><mrow><mi>Y</mi><mi>X</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mfrac><mn>1</mn><mi>n</mi></mfrac><mi mathvariant=normal >Φ</mi><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mtext>and</mtext><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msub><mover accent=true ><mi mathvariant=script >C</mi><mo stretchy=true >^</mo></mover><mrow><mi>X</mi><mi>X</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi mathvariant=normal >Υ</mi><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \widehat\mathcal C_{YX} \quad\!\! =\quad\!\! {1\over n}\Phi\Upsilon^t\quad\!\!\text{and}\quad\!\! \widehat\mathcal C_{XX} \quad\!\! =\quad\!\! = {1\over n}\Upsilon\Upsilon^t, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.07333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.92333em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class=svg-align  style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class=mord >Φ</span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class="mord text"><span class=mord >and</span></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.92333em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class=svg-align  style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class=mord >Υ</span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=normal >Φ</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Φ</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi mathvariant=normal >Υ</mi></mrow><annotation encoding="application/x-tex">\Upsilon</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Υ</span></span></span></span> are defined as before &#40;see equation <span class=eqref >(<a href="#empirical-cxy">12</a>)</span>&#41;. Using a trick from linear algebra for the regularised inverse &#40;coming from an application of Woodbury&#39;s formula&#41;, we have:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mover accent=true ><mi mathvariant=script >C</mi><mo stretchy=true >^</mo></mover><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=normal >Φ</mi><mrow><mo fence=true >[</mo><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mrow><mo fence=true >(</mo><mi>λ</mi><mi>I</mi><mo>+</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=normal >Υ</mi><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mo fence=true >)</mo></mrow><mo fence=true >]</mo></mrow><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=normal >Φ</mi><mrow><mo fence=true >[</mo><mi>n</mi><mo>(</mo><mi>λ</mi><mi>I</mi><mo>+</mo><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mi mathvariant=normal >Υ</mi><mo>)</mo><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mo fence=true >]</mo></mrow><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \widehat\mathcal C_{Y|X} \quad\!\! =\quad\!\! n^{-1} \Phi \left[\Upsilon^t\left(\lambda I + n^{-1}\Upsilon\Upsilon^t\right)\right] \quad\!\! =\quad\!\! n^{-1}\Phi\left[n(\lambda I + \Upsilon^t\Upsilon)\Upsilon^t\right],</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.27853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.92333em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class=svg-align  style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1.214118em;vertical-align:-0.35001em;"></span><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord >Φ</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathdefault">λ</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord >Υ</span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1.214118em;vertical-align:-0.35001em;"></span><span class=mord ><span class="mord mathdefault">n</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord >Φ</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord mathdefault">n</span><span class=mopen >(</span><span class="mord mathdefault">λ</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class=mord >Υ</span><span class=mclose >)</span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span> <p>which gives an estimator for the conditional embedding operator.</p> <div class=colbox-blue >A finite sample estimator for the conditional embedding operator is <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mover accent=true ><mi mathvariant=script >C</mi><mo stretchy=true >^</mo></mover><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>X</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi mathvariant=normal >Φ</mi><mo>[</mo><mi>K</mi><mo>+</mo><mi>λ</mi><mi>I</mi><msup><mo>]</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex"> \widehat\mathcal C_{Y|X} \quad\!\! =\quad\!\! \Phi[K+\lambda I]^{-1}\Upsilon^t </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.27853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.92333em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span><span class=svg-align  style="width:calc(100% - 0.16668em);margin-left:0.16668em;top:-3.6833299999999998em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05834em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >Φ</span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class=mclose ><span class=mclose >]</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span></span> where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>K</mi><mo>:</mo><mo>=</mo><msup><mi mathvariant=normal >Υ</mi><mi>t</mi></msup><mi mathvariant=normal >Υ</mi></mrow><annotation encoding="application/x-tex">K:=\Upsilon^t\Upsilon</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7935559999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord >Υ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class=mord >Υ</span></span></span></span> is the Gram matrix.</div> <p>The regularisation parameter <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> helps to control for overfitting. The resulting kernel embedding is then</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mover accent=true ><mi>μ</mi><mo stretchy=true >^</mo></mover><mrow><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>x</mi></mrow></msub><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mo>=</mo><mspace width=1em /><mtext> ⁣</mtext><mtext> ⁣</mtext><mi mathvariant=normal >Φ</mi><mi>β</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex"> \widehat\mu_{Y|x} \quad\!\! =\quad\!\! \Phi\beta(x) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.02576em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.67056em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathdefault">μ</span></span><span class=svg-align  style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class=pstrut  style="height:3em;"></span><span style="height:0.24em;"><svg width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22 c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span><span class=mspace  style="margin-right:-0.16666666666666666em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >Φ</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>β</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>:</mo><mo>=</mo><mo>(</mo><mi>K</mi><mo>+</mo><mi>λ</mi><mi>I</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>K</mi><mrow><mo>:</mo><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta(x):= (K+\lambda I)^{-1}K_{:x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">:</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math><semantics><mrow><msub><mi>K</mi><mrow><mo>:</mo><mi>x</mi></mrow></msub><mo>:</mo><mo>=</mo><mo>[</mo><mi>k</mi><mo>(</mo><mi>x</mi><mo separator=true >,</mo><msub><mi>x</mi><mi>i</mi></msub><mo>)</mo><msubsup><mo>]</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">K_{:x}:=[k(x, x_i)]_{i=1}^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">:</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span></span><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.008664em;vertical-align:-0.258664em;"></span><span class=mopen >[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class=mopen >(</span><span class="mord mathdefault">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathdefault">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mclose ><span class=mclose >]</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span> . It is thus a weighted sum of samples of <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> in the feature space with weights depending on the conditioning variable <span class=katex ><span class=katex-mathml ><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> .</p> <h2><a id=references  href="#references">References</a></h2> <ol> <li><p><a id=fukumizu04 ></a> <strong>Fukumizu</strong>, <strong>Bach</strong> and <strong>Jordan</strong>, <a href="http://www.jmlr.org/papers/volume5/fukumizu04a/fukumizu04a.ps">Dimensionality reduction for supervised learning with reproducing kernel Hilbert spaces</a>, 2004. A key paper in the RKHS literature.</p> <li><p><a id=gretton07 ></a> <strong>Gretton</strong>, <strong>Fukumizu</strong>, <strong>Hui Teo</strong>, <strong>Le Song</strong>, <strong>Schölkopf</strong>, <strong>Smola</strong>, <a href="http://www.kyb.mpg.de/fileadmin/user_upload/files/publications/attachments/NIPS2007-Gretton_&#37;5b0&#37;5d.pdf">A kernel statistical test of independence</a>, 2007. Paper describing how to perform an independence test using the HSIC.</p> <li><p><a id=gretton12a ></a> <strong>Gretton</strong>, <strong>Borgwardt</strong>, <strong>Rasch</strong>, <strong>Schölkopf</strong>, <strong>Smola</strong>, <a href="http://www.jmlr.org/papers/volume13/gretton12a/gretton12a.pdf">A kernel two-sample test</a>, 2012. Paper describing how to perform a two-sample test using the MMD.</p> <li><p><a id=gretton12b ></a> <strong>Gretton</strong>, <strong>Sriperumbudur</strong>, <strong>Sejdinovic</strong>, <strong>Strathmann</strong>, <strong>Balakrishnan</strong>, <strong>Pontil</strong> and <strong>Fukumizu</strong>, <a href="http://www.gatsby.ucl.ac.uk/~gretton/papers/GreSriSejStrBalPonFuk12.pdf">Optimal kernel choice for large-scale two-sample tests</a>, 2012. Another paper describing how to perform a two-sample test using the MMD focusing on computational perspectives.</p> <li><p><a id=song13 ></a> <strong>Song</strong>, <strong>Fukumizu</strong> and <strong>Gretton</strong>, <a href="https://www.cc.gatech.edu/~lsong/papers/SonFukGre13.pdf">Kernel embeddings of conditional distributions</a>, 2013. The paper these notes are mainly based on.</p> </ol> <div class=page-foot > <div class=copyright > &copy; T. Lienart. Last modified: October 27, 2018. Website built with <a href="https://github.com/tlienart/JuDoc.jl">JuDoc.jl</a>. </div> </div> </div>